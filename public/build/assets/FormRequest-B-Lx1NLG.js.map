{"version":3,"file":"FormRequest-B-Lx1NLG.js","sources":["../../../resources/js/core/FormRequest.js"],"sourcesContent":["// eslint-disable-next-line no-unused-vars\nexport class FormRequest {\n  constructor(options, formId = '__form__request') {\n    this.options = options;\n    this.formId = formId;\n    this.formEl = $(`#${formId}`);\n    this.cardBody = this.formEl.find('.card-body');\n    this.init();\n  }\n\n  async formSubmit(event) {\n    event.preventDefault();\n    const form = event.target;\n\n    const method = $(form).attr('method');\n    const url = $(form).attr('action');\n    const formData = new FormData(form);\n    await this.sendData(method, url, formData);\n  }\n\n  async sendData(method, url, formData) {\n    this.formEl.find('.validation-error').html('');\n    this.formRequestLoader();\n\n    if (this.__checkOptionMethodsExist() && this.options.methods.beforeSendRequest) {\n      this.options.methods.beforeSendRequest();\n    }\n\n    this.formLoad();\n\n    // eslint-disable-next-line no-undef\n    await axios.post(url, formData)\n      .then(this.successHandler.bind(this))\n      .catch(this.errorHandler.bind(this));\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  successHandler(resp) {\n    resp = resp.data;\n\n    if (this.__checkOptionMethodsExist() && this.options.methods.afterSuccess) {\n      this.formLoad(false);\n      this.formRequestLoader(false);\n      return this.options.methods.afterSuccess(resp);\n    }\n\n    if (resp.redirectUrl) {\n      localStorage.setItem('_message', resp.message);\n      location.href = resp.redirectUrl;\n    } else {\n      this.formRequestLoader(false);\n      this.formLoad(false);\n    }\n  }\n\n  errorHandler(error) {\n    if (error.response && error.response.data.errors) {\n      error = error.response.data;\n\n      this.formEl.find('.validation-error').removeClass('has-error');\n      $('.form-group').removeClass('is-invalid');\n      // eslint-disable-next-line no-restricted-syntax\n      for (const [key, value] of Object.entries(error.errors)) {\n        let hasErrorSpan = this.formEl.find(`.validation-error[data-name=\"${key}\"]`);\n\n        if (!hasErrorSpan.length) {\n          hasErrorSpan = this.formEl.find(`.validation-error[data-name=\"${key}[]\"]`);\n        }\n\n        hasErrorSpan.closest('.form-group').addClass('is-invalid');\n        hasErrorSpan.html(value).addClass('has-error');\n      }\n\n      this.scrollToFirstError();\n\n      if (this.__checkOptionMethodsExist() && this.options.methods.afterError) {\n        this.options.methods.afterError(error);\n      }\n    }\n\n    this.formRequestLoader(false);\n    this.formLoad(false);\n  }\n\n  scrollToFirstError() {\n    const firstError = this.formEl.find('.validation-error.has-error').first();\n\n    if (firstError.closest('.tab-pane')) {\n      $(`.nav-tabs a[href=\"#${firstError.closest('.tab-pane').attr('id')}\"]`).tab('show');\n    }\n\n    if (firstError.length) {\n      setTimeout(() => {\n        $('html, body').animate({\n          scrollTop: firstError.offset().top - 300,\n        }, 200);\n      }, 150);\n    }\n  }\n\n  formRequestLoader(is = true) {\n    const spinner = this.formEl.find('button.form__request__send__btn .spinner-border');\n    const btn = this.formEl.find('button.form__request__send__btn');\n    if (is) {\n      spinner.css({ display: 'inline-block' });\n      btn.prop('disabled', true);\n    } else {\n      spinner.hide();\n      btn.prop('disabled', false);\n    }\n  }\n\n  formLoad(is = true) {\n    if (is) {\n      this.cardBody.addClass('loading-content');\n    } else {\n      this.cardBody.removeClass('loading-content');\n    }\n  }\n\n  showMode() {\n    this.formEl.find(':input').prop('disabled', true);\n  }\n\n  clickSubmit() {\n    this.formEl.submit(this.formSubmit.bind(this));\n  }\n\n  init() {\n    if (this.formEl.hasClass('show-mode')) {\n      this.showMode();\n    }\n\n    this.clickSubmit();\n    this.formRequestLoader(false);\n    this.formLoad(false);\n  }\n\n  __checkOptionMethodsExist() {\n    return typeof this.options != 'undefined' && typeof this.options.methods != 'undefined';\n  }\n}\n"],"names":["__vite_legacy_guard","FormRequest","options","formId","event","form","method","url","formData","resp","error","key","value","hasErrorSpan","firstError","is","spinner","btn"],"mappings":"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"}